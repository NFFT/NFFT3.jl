<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Fast Summation Algorithm · NFFT3</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">NFFT3</span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li><a class="tocitem" href="about.html">About</a></li><li><a class="tocitem" href="Flags.html">Flags</a></li><li><span class="tocitem">Transformations</span><ul><li><a class="tocitem" href="NFFT.html">NFFT</a></li><li><a class="tocitem" href="NFST.html">NFST</a></li><li><a class="tocitem" href="NFCT.html">NFCT</a></li></ul></li><li class="is-active"><a class="tocitem" href="fastsum.html">Fast Summation Algorithm</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Fast-Summation-at-Nonequispaced-Knots"><span>Fast Summation at Nonequispaced Knots</span></a></li><li class="toplevel"><a class="tocitem" href="#Functions"><span>Functions</span></a></li><li><a class="tocitem" href="#Literature"><span>Literature</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="fastsum.html">Fast Summation Algorithm</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="fastsum.html">Fast Summation Algorithm</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NFFT/NFFT3/blob/master/docs/src/fastsum.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="fastsum"><a class="docs-heading-anchor" href="#fastsum">Fast Summation Algorithm</a><a id="fastsum-1"></a><a class="docs-heading-anchor-permalink" href="#fastsum" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="NFFT3.FASTSUM" href="#NFFT3.FASTSUM"><code>NFFT3.FASTSUM</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">FASTSUM</code></pre><p>The fast summation algorithm evaluates the function</p><p class="math-container">\[f (y) \coloneqq \sum^{N}_{k = 1} \alpha_k \mathscr{K} (y - x_k) = \sum^{N}_{k = 1} \alpha_k K (\lVert y - x_k \rVert_2)\]</p><p>for given (nonequispaced) source knots <span>$x_k \in \mathbb{R}^d, \; k = 1, \cdots, N$</span> and a given kernel function <span>$\mathscr{K} (\cdot) = K (\lVert \cdot \rVert_2), \; x \in \mathbb{R}^d$</span>, which is an even, real univariate function which is infinitely differentiable at least in <span>$\mathbb{R} \setminus \{ 0 \}$</span>. If <span>$K$</span> is infinitely differentiable at zero as well, then <span>$\mathscr{K}$</span> is defined on <span>$\mathbb{R}^d$</span> and is called nonsingular kernel function. The evaluation is done at <span>$M$</span> different points <span>$y_j \in \mathbb{R}^d, \; j = 1, \cdots, M$</span>. </p><p><strong>Fields</strong></p><ul><li><code>d</code> - dimension.</li><li><code>N</code> - number of source nodes.</li><li><code>M</code> - number of target nodes.</li><li><code>n</code> - expansion degree.</li><li><code>p</code> - degree of smoothness.</li><li><code>kernel</code> - name of kernel.</li><li><code>c</code> - kernel parameters.</li><li><code>eps_I</code> - inner boundary.</li><li><code>eps_B</code> - outer boundary.</li><li><code>nn_x</code> - oversampled nn in x.</li><li><code>nn_y</code> - oversampled nn in y.</li><li><code>m_x</code> - NFFT-cutoff in x.</li><li><code>m_y</code> - NFFT-cutoff in y.</li><li><code>init_done</code> - bool for plan init.</li><li><code>finalized</code> - bool for finalizer.</li><li><code>flags</code> - flags.</li><li><code>x</code> - source nodes.</li><li><code>y</code> - target nodes.</li><li><code>alpha</code> - source coefficients.</li><li><code>f</code> - target evaluations.</li><li><code>plan</code> - plan (C pointer).</li></ul><p><strong>Constructor</strong></p><pre><code class="language-none">FASTSUM(d::Integer,N::Integer,M::Integer,n::Integer,p::Integer,kernel::String,c::Vector{&lt;:Real},eps_I::Real,eps_B::Real,nn_x::Integer,nn_y::Integer,m_x::Integer,m_y::Integer,flags::UInt32)</code></pre><p><strong>Additional Constructor</strong></p><pre><code class="language-none">FASTSUM(d::Integer,N::Integer,M::Integer,n::Integer,p::Integer,kernel::String,c::Real,eps_I::Real,eps_B::Real,nn::Integer,m::Integer)</code></pre><p><strong>See also</strong></p><p><a href="NFFT.html#NFFT3.NFFT"><code>NFFT</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NFFT/NFFT3/blob/741a2df0fd8d914250d40f423cd40ab22de622dd/src/fastsum.jl#L3-L45">source</a></section></article><h1 id="Fast-Summation-at-Nonequispaced-Knots"><a class="docs-heading-anchor" href="#Fast-Summation-at-Nonequispaced-Knots">Fast Summation at Nonequispaced Knots</a><a id="Fast-Summation-at-Nonequispaced-Knots-1"></a><a class="docs-heading-anchor-permalink" href="#Fast-Summation-at-Nonequispaced-Knots" title="Permalink"></a></h1><p>The fast summation algorithm evaluates the function </p><p class="math-container">\[    f(y) \coloneqq \sum_{k=1}^{M_1} \alpha_k \ \mathscr{K} (y-x_k)\]</p><p>for given (nonequispaced) source knots <span>$x_k \in \mathbb{R}^d,\ k = 1, \ldots, M_1$</span> and a given kernel function <span>$\mathscr{K} (x) \coloneqq K(\lVert x \rVert_2),\ x \in \mathbb{R}^d$</span>. Here, <span>$K$</span> is required to be infinitely differentiable at <span>$x \in \mathbb{R} \setminus \{ 0 \}$</span>. If <span>$K$</span> is even infinitely differentiable at <span>$0$</span>, <span>$\mathscr{K}$</span> is called <em>nonsingular kernel function</em>, otherwise <em>singular kernel function</em>.  <br/>The evaluation is done at <span>$M_2$</span> different points <span>$y_j \in \mathbb{R}^d,\ j=0, \ldots, M_2$</span>. W.l.o.g. we assume <span>$y_j \neq x_i  \ (j\neq i)$</span>, i.e., one wants to compute</p><p class="math-container">\[    f(y_j) \coloneqq \sum_{k=1}^{M_1} \alpha_k \ \mathscr{K} (y_j-x_k), \qquad j=1,\ldots,M_2.\]</p><p>We replace <span>$\mathscr{K}$</span> in the definition above by a periodic function. Hence, we assume <span>$\lVert y_k \rVert_2 \leq \frac{1}{2} \ (\pi - \varepsilon_B)$</span> and <span>$\lVert x_k \rVert_2 \leq \frac{1}{2} \ (\pi - \varepsilon_B)$</span> with <span>$\varepsilon_B \in (0,\pi)$</span>. By the triangle inequality, we conclude </p><p class="math-container">\[    y_j-x_i \in [-\pi+\varepsilon_B, \pi-\varepsilon_B]\]</p><p>Next, we regularize the kernel near zero and <span>$\pm \pi$</span>:</p><p class="math-container">\[    K_R (x) \coloneqq \begin{cases} T_I(x) &amp; \lvert x \rvert &lt; \varepsilon_I \\ K(x) &amp; \varepsilon_I &lt; \lvert x \rvert \leq \pi - \varepsilon_B \\ T_B(\lvert x \rvert) &amp; \pi - \varepsilon_B &lt; \lvert x \rvert \leq \pi \end{cases}\]</p><p>With <span>$\lvert x \rvert \coloneqq (\lvert x_k \rvert)_{k=0}^{N-1}$</span> we mean to componentwise absolute value and <span>$T_I,\, T_B \in \mathcal{P}_{2p-1}$</span> are chosen such that the <span>$2\pi$</span>-periodic extension of <span>$K_R$</span> is of class <span>$\mathcal{C}^{p-1}$</span>. Further details about the computation of <span>$T_I, T_B$</span> are given in Chapter 7.5, [<a href="#PlonkaPottsSteidlTasche2018">Plonka, Potts, Steidl, Tasche, 2018</a>].  <br/>We define </p><p class="math-container">\[    \mathscr{K}_R (x) \coloneqq \begin{cases} K_R (\lVert x \rVert_2) &amp; \lVert x \rVert &lt; \pi \\ T_B (\pi) &amp; \lVert x \rVert_2 \geq \pi \end{cases}\]</p><p>Since <span>$\mathscr{K}_R$</span> is sufficiently smooth, we replace it by its partial sum  <span>$\mathscr{K}_{RF} (x) \coloneqq \sum_{\pmb{l} \in I_n^d} b_{\pmb{l}}\mathrm{e}^{\mathrm{i} \ \pmb{l} \cdot x}$</span> and obtain <span>$\mathscr{K} \approx \mathscr{K} - \mathscr{K}_R + \mathscr{K}_{RF}$</span>. Using quadrature rules, we replace <span>$b_{\pmb{l}}$</span> by</p><p class="math-container">\[    b_{\pmb{l}} \coloneqq \frac{1}{n^d} \sum_{j \in I_n^d} \mathscr{K}_R(\frac{2 \pi j}{n}) \mathrm{e}^{-2 \pi j * \pmb{l} / n}, \quad \pmb{l} \in I_n^d \coloneqq [- \frac{n}{2},\frac{n}{2} ]^d \cap \mathbb{Z}^d \]</p><p>Hence, we have to compute the <em>nearfield sum</em></p><p class="math-container">\[    f_{NE} (x) \coloneqq \sum_{k=1}^{M_1} \alpha_k \mathscr{K}_{NE} (x-x_k), \quad \mathscr{K}_{NE} \coloneqq \mathscr{K} - \mathscr{K}_R\]</p><p>and the <em>far field sum</em></p><p class="math-container">\[    f_{RF} (x) \coloneqq \sum_{k=1}^{M_1} \alpha_k \mathscr{K}_{RF} (x-x_k)\]</p><p>and approximate <span>$f$</span> by <span>$\tilde{f} \coloneqq f_{NE} + f_{RF}$</span>. <br/>From <span>$y_j-x_i \in [-\pi+\varepsilon_B, \pi-\varepsilon_B]$</span> and the definition of <span>$K_R (\cdot)$</span> we conclude that for the evaluation of <span>$f_{NE}$</span> we only need to consider  <span>$x$</span> fulfilling <span>$\lVert x \rVert \leq \varepsilon_I$</span>. Assuming a certain kind of uniform distribution of the <span>$x_k,\ y_i$</span>, we obtain an arithmetic cost of <span>$\mathcal{O}(M_2)$</span>. <br/>For the evaluation of <span>$f_{RF}(\cdot)$</span>, we rearrange the sums</p><p class="math-container">\[    f_{RF}(y)= \sum_{k=1}^{M_1} \alpha_k \sum_{\pmb{l} \in I_n^d} b_{\pmb{l}} \ \mathrm{e}^{ \mathrm{i} \ \pmb{l} \cdot ( y - x_k )} = \sum_{\pmb{l} \in I_n^d} b_{\pmb{l}}\, (\sum_{k=1}^{M_1} \alpha_k \ \mathrm{e}^{- \mathrm{i} \pmb{l} x_k})\, \mathrm{e}^{\mathrm{i} \ \pmb{l} \cdot y}\]</p><p>where the inner sum can be computed by a NFFT<span>$^\mathrm{T}$</span> which is then followed by a NFFT for the computation of the outer sum. </p><h3 id="Pseudocode"><a class="docs-heading-anchor" href="#Pseudocode">Pseudocode</a><a id="Pseudocode-1"></a><a class="docs-heading-anchor-permalink" href="#Pseudocode" title="Permalink"></a></h3><p><strong>Input:</strong> <span>$\alpha_k \in \mathbb{C} \text{ for } k = 1, \ldots, M_1, \; x_k \in \mathbb{R}^d \text{ for } k = 1, \ldots, M_1 \text{ with } \lVert x_k \rVert_2 \leq \frac{1}{2} \ (\pi - \varepsilon_B), \; y_j \in \mathbb{R}^d \text{ for } j = 1, \ldots, M_2 \text{ with } \lVert y_j \rVert_2 \leq \frac{1}{2} \ (\pi - \varepsilon_B).$</span></p><p><strong>Precomputation:</strong> Compute the polynomials <span>$T_I$</span> and <span>$T_B$</span>. Compute <span>$(b_{\pmb{l}})_{\pmb{l} \in I^d_n}$</span>. Compute <span>$\mathscr{K}_{NE} (y_j - x_k) \text{ for } j = 1, \ldots, M_2 \text{ and } k \in I^{NE}_{\varepsilon_I}(j), \text{ where } I^{NE}_{\varepsilon_I}(j) \coloneqq \{ k \in \{ 1, \ldots, M_1 \} \colon \lVert y_j - x_k \rVert_2 &lt; \varepsilon_I \}$</span>.</p><ol><li>For each <span>$\pmb{l} \in I^d_n$</span> compute <span>$\alpha_{\pmb{l}} \coloneqq \sum^{M_1}_{k = 1} \alpha_k e^{ - \mathrm{i} \ \pmb{l} \cdot x_k}$</span> using the d-variate NFFT<span>$^\mathrm{T}$</span> of size <span>$n \times \ldots \times n$</span>, see Algorithm 7.3 in [<a href="#PlonkaPottsSteidlTasche2018">Plonka, Potts, Steidl, Tasche, 2018</a>].</li><li>For each <span>$\pmb{l} \in I^d_n$</span> compute the products <span>$d_{\pmb{l}} \coloneqq a_{\pmb{l}} b_{\pmb{l}}$</span>.</li><li>For <span>$j = 1, \ldots, M_2$</span> compute the far field sums <span>$f_{RF}(y_j) = \sum_{\pmb{l} \in I_n^d} d_{\pmb{l}} \ \mathrm{e}^{ \mathrm{i} \ \pmb{l} \cdot y_j}$</span> using the d-variate NFFT of size <span>$n \times \ldots \times n$</span>, see Algorithm 7.1 in [<a href="#PlonkaPottsSteidlTasche2018">Plonka, Potts, Steidl, Tasche, 2018</a>].</li><li>For <span>$j = 1, \ldots, M_2$</span> compute the near field sums <span>$f_{NE} (y_j) \coloneqq \sum_{k \in I^{NE}_{\varepsilon_I}(j)} \alpha_k \mathscr{K}_{NE} (y_j - x_k)$</span>.</li><li>For <span>$j = 1, \ldots, M_2$</span> compute the near field corrections <span>$\tilde{f}(y_j) \coloneqq f_{NE}(y_j) + f_{RF}(y_j)$</span>.</li></ol><p><strong>Output:</strong> <span>$\tilde{f}(y_j), \, j = 1, \ldots, M_2$</span>, approximate values of <span>$f(y_j)$</span>.</p><p><strong>Computational cost:</strong> <span>$\mathcal{O}(m^d (M_1+M_2)+ n^d \log n)$</span> </p><h1 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="NFFT3.fastsum_init" href="#NFFT3.fastsum_init"><code>NFFT3.fastsum_init</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">fastsum_init(P)</code></pre><p>intialises a transform plan.</p><p><strong>Input</strong></p><ul><li><code>P</code> - a FASTSUM plan structure.</li></ul><p><strong>See also</strong></p><p><a href="fastsum.html#NFFT3.FASTSUM"><code>FASTSUM{D}</code></a>, <a href="fastsum.html#NFFT3.fastsum_finalize_plan"><code>fastsum_finalize_plan</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NFFT/NFFT3/blob/741a2df0fd8d914250d40f423cd40ab22de622dd/src/fastsum.jl#L143-L153">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NFFT3.fastsum_finalize_plan" href="#NFFT3.fastsum_finalize_plan"><code>NFFT3.fastsum_finalize_plan</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">fastsum_finalize_plan(P)</code></pre><p>destroys a FASTSUM plan structure.</p><p><strong>Input</strong></p><ul><li><code>P</code> - a FASTSUM plan structure.</li></ul><p><strong>See also</strong></p><p><a href="fastsum.html#NFFT3.FASTSUM"><code>FASTSUM{D}</code></a>, <a href="fastsum.html#NFFT3.fastsum_init"><code>fastsum_init</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NFFT/NFFT3/blob/741a2df0fd8d914250d40f423cd40ab22de622dd/src/fastsum.jl#L209-L219">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NFFT3.fastsum_trafo" href="#NFFT3.fastsum_trafo"><code>NFFT3.fastsum_trafo</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">fastsum_trafo(P)</code></pre><p>fast NFFT-based summation.</p><p><strong>Input</strong></p><ul><li><code>P</code> - a FASTSUM plan structure.</li></ul><p><strong>See also</strong></p><p><a href="fastsum.html#NFFT3.FASTSUM"><code>FASTSUM{D}</code></a>, <a href="fastsum.html#NFFT3.fastsum_trafo_exact"><code>fastsum_trafo_exact</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NFFT/NFFT3/blob/741a2df0fd8d914250d40f423cd40ab22de622dd/src/fastsum.jl#L407-L417">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NFFT3.fastsum_trafo_exact" href="#NFFT3.fastsum_trafo_exact"><code>NFFT3.fastsum_trafo_exact</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">fastsum_trafo_exact(P)</code></pre><p>direct computation of sums.</p><p><strong>Input</strong></p><ul><li><code>P</code> - a FASTSUM plan structure.</li></ul><p><strong>See also</strong></p><p><a href="fastsum.html#NFFT3.FASTSUM"><code>FASTSUM{D}</code></a>, <a href="fastsum.html#NFFT3.fastsum_trafo"><code>fastsum_trafo</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NFFT/NFFT3/blob/741a2df0fd8d914250d40f423cd40ab22de622dd/src/fastsum.jl#L450-L460">source</a></section></article><h2 id="Literature"><a class="docs-heading-anchor" href="#Literature">Literature</a><a id="Literature-1"></a><a class="docs-heading-anchor-permalink" href="#Literature" title="Permalink"></a></h2><ul>
<li id="PlonkaPottsSteidlTasche2018">[<a>Plonka, Potts, Steidl, Tasche, 2018</a>]
  G. Plonka, D. Potts, G. Steidl and M. Tasche. Numerical Fourier Analysis: Theory and Applications.</emph>
  Springer Nature Switzerland AG, 2018.
  doi: <a href="https://doi.org/10.1007/978-3-030-04306-3">10.1007/978-3-030-04306-3</a>.
</li>
</ul><ul>
<li id="Schmischke2018">[<a>Schmischke, 2018</a>]
  M. Schmischke. Nonequispaced Fast Fourier Transform (NFFT) Interface for Julia.</emph>
  2018.
  arXiv: <a href="https://arxiv.org/abs/1810.09891">1512.02814</a>.
</li>
</ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="NFCT.html">« NFCT</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 30 June 2021 12:53">Wednesday 30 June 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
